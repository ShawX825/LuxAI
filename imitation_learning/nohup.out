/home/l/liuxiao/anaconda3/envs/smc/lib/python3.8/site-packages/torch/cuda/__init__.py:52: UserWarning: CUDA initialization: The NVIDIA driver on your system is too old (found version 10010). Please update your GPU driver by downloading and installing a new version from the URL: http://www.nvidia.com/Download/index.aspx Alternatively, go to: https://pytorch.org to install a PyTorch version that has been compiled with your version of the CUDA driver. (Triggered internally at  /opt/conda/conda-bld/pytorch_1623448234945/work/c10/cuda/CUDAFunctions.cpp:115.)
  return torch._C._cuda_getDeviceCount() > 0
using  cpu
Traceback (most recent call last):
  File "main.py", line 7, in <module>
    main()
  File "main.py", line 4, in main
    train()
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 56, in train
    obses, samples = create_dataset_from_json(episode_dir)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/dataloader.py", line 30, in create_dataset_from_json
    with open(fp, 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: '27876807.json'
/home/l/liuxiao/anaconda3/envs/smc/lib/python3.8/site-packages/torch/cuda/__init__.py:52: UserWarning: CUDA initialization: The NVIDIA driver on your system is too old (found version 10010). Please update your GPU driver by downloading and installing a new version from the URL: http://www.nvidia.com/Download/index.aspx Alternatively, go to: https://pytorch.org to install a PyTorch version that has been compiled with your version of the CUDA driver. (Triggered internally at  /opt/conda/conda-bld/pytorch_1623448234945/work/c10/cuda/CUDAFunctions.cpp:115.)
  return torch._C._cuda_getDeviceCount() > 0
using  cpu
obses: 133664 samples: 1191535
north: 270058
south: 281555
west : 302862
east : 287825
bcity: 49235
Traceback (most recent call last):
  File "main.py", line 7, in <module>
    main()
  File "main.py", line 4, in main
    train()
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 83, in train
    train_model(model, dataloaders_dict, criterion, optimizer, num_epochs=15)
TypeError: train_model() missing 1 required positional argument: 'device'
using  cuda
obses: 132822 samples: 1222173
north: 289693
south: 284994
west : 296865
east : 302619
bcity: 48002
Epoch 1/15 | train | Loss: 1.0004 | Acc: 0.5719
Epoch 1/15 |  val  | Loss: 0.9358 | Acc: 0.6045
Traceback (most recent call last):
  File "main.py", line 7, in <module>
    main()
  File "main.py", line 4, in main
    train()
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 83, in train
    train_model(model, dataloaders_dict, criterion, optimizer, num_epochs=15, device=device)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 29, in train_model
    policy = model(states)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 29, in forward
    h = F.relu_(self.conv0(x))
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 16, in forward
    h = self.conv(x)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 423, in forward
    return self._conv_forward(input, self.weight)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 420, in _conv_forward
    self.padding, self.dilation, self.groups)
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
using  cuda
obses: 66443 samples: 616862
north: 141519
south: 145564
west : 148028
east : 157391
bcity: 24360
Epoch 1/15 | train | Loss: 1.0446 | Acc: 0.5485
Epoch 1/15 |  val  | Loss: 0.9721 | Acc: 0.5849
Traceback (most recent call last):
  File "main.py", line 7, in <module>
    main()
  File "main.py", line 4, in main
    train()
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 83, in train
    train_model(model, dataloaders_dict, criterion, optimizer, num_epochs=15, device=device)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 29, in train_model
    policy = model(states)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 29, in forward
    h = F.relu_(self.conv0(x))
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 16, in forward
    h = self.conv(x)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 423, in forward
    return self._conv_forward(input, self.weight)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 420, in _conv_forward
    self.padding, self.dilation, self.groups)
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
using  cuda
obses: 13463 samples: 126403
north: 31525
south: 27421
west : 32425
east : 30210
bcity: 4822 

Epoch 15/15 |  val  | Loss: 0.9049 | Acc: 0.6377
usage: main.py [-h] [--batch_size BATCH_SIZE] [--lr LR] [--epoch EPOCH]
               [--save_every SAVE_EVERY] [--load_prop LOAD_PROP]
               [--load_last_ckpt LOAD_LAST_CKPT]
               [--last_ckpt_dir LAST_CKPT_DIR]
main.py: error: unrecognized arguments: --data_prop 1.0
using  cuda
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 85, in train
    obses, samples = create_dataset_from_json(episode_dir, load_prop=load_prop)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/dataloader.py", line 57, in create_dataset_from_json
    for action in actions:
TypeError: 'NoneType' object is not iterable
using  cuda

obses: 1242207 samples: 12135807
north: 2823989
south: 2830677
west : 3018519
east : 2969921
bcity: 492701
Epoch 1/30 | train | Loss: 0.9122 | Acc: 0.6150
Epoch 1/30 |  val  | Loss: 0.8812 | Acc: 0.6291
Epoch 2/30 | train | Loss: 0.8674 | Acc: 0.6353
Epoch 2/30 |  val  | Loss: 0.8552 | Acc: 0.6406
Epoch 3/30 | train | Loss: 0.8560 | Acc: 0.6404
Epoch 3/30 |  val  | Loss: 0.8456 | Acc: 0.6448
Epoch 4/30 | train | Loss: 0.8500 | Acc: 0.6429
Epoch 4/30 |  val  | Loss: 0.8422 | Acc: 0.6462
Epoch 5/30 | train | Loss: 0.8460 | Acc: 0.6446
Epoch 5/30 |  val  | Loss: 0.8483 | Acc: 0.6438
Epoch 6/30 | train | Loss: 0.8437 | Acc: 0.6459
Epoch 6/30 |  val  | Loss: 0.8399 | Acc: 0.6480
Epoch 7/30 | train | Loss: 0.8417 | Acc: 0.6467
Epoch 7/30 |  val  | Loss: 0.8403 | Acc: 0.6468
Epoch 8/30 | train | Loss: 0.8403 | Acc: 0.6474
Epoch 8/30 |  val  | Loss: 0.8418 | Acc: 0.6463
Epoch 9/30 | train | Loss: 0.8394 | Acc: 0.6478
Epoch 9/30 |  val  | Loss: 0.8400 | Acc: 0.6470
Epoch 10/30 | train | Loss: 0.8386 | Acc: 0.6483
Epoch 10/30 |  val  | Loss: 0.8377 | Acc: 0.6480
Epoch 11/30 | train | Loss: 0.8380 | Acc: 0.6483
Epoch 11/30 |  val  | Loss: 0.8315 | Acc: 0.6515
Epoch 12/30 | train | Loss: 0.8374 | Acc: 0.6488
Epoch 12/30 |  val  | Loss: 0.8363 | Acc: 0.6487
Epoch 13/30 | train | Loss: 0.8371 | Acc: 0.6487
Epoch 13/30 |  val  | Loss: 0.8322 | Acc: 0.6508
Epoch 14/30 | train | Loss: 0.8365 | Acc: 0.6490
Epoch 14/30 |  val  | Loss: 0.8355 | Acc: 0.6496
Epoch 15/30 | train | Loss: 0.8362 | Acc: 0.6492
Epoch 15/30 |  val  | Loss: 0.8375 | Acc: 0.6484
Epoch 16/30 | train | Loss: 0.8357 | Acc: 0.6495
Epoch 16/30 |  val  | Loss: 0.8392 | Acc: 0.6473
Epoch 17/30 | train | Loss: 0.8355 | Acc: 0.6496
Epoch 17/30 |  val  | Loss: 0.8319 | Acc: 0.6515
Epoch 18/30 | train | Loss: 0.8352 | Acc: 0.6498
Epoch 18/30 |  val  | Loss: 0.8332 | Acc: 0.6500
Epoch 19/30 | train | Loss: 0.8348 | Acc: 0.6499
Epoch 19/30 |  val  | Loss: 0.8321 | Acc: 0.6506
Epoch 20/30 | train | Loss: 0.8346 | Acc: 0.6500
Epoch 20/30 |  val  | Loss: 0.8354 | Acc: 0.6503
Epoch 21/30 | train | Loss: 0.8343 | Acc: 0.6502
Epoch 21/30 |  val  | Loss: 0.8321 | Acc: 0.6513
Epoch 22/30 | train | Loss: 0.8340 | Acc: 0.6503
Epoch 22/30 |  val  | Loss: 0.8350 | Acc: 0.6501
Epoch 23/30 | train | Loss: 0.8338 | Acc: 0.6504
Epoch 23/30 |  val  | Loss: 0.8320 | Acc: 0.6510
Epoch 24/30 | train | Loss: 0.8337 | Acc: 0.6504
Epoch 24/30 |  val  | Loss: 0.8306 | Acc: 0.6523
Epoch 25/30 | train | Loss: 0.8337 | Acc: 0.6503
Epoch 25/30 |  val  | Loss: 0.8325 | Acc: 0.6514
Epoch 26/30 | train | Loss: 0.8335 | Acc: 0.6505
Epoch 26/30 |  val  | Loss: 0.8291 | Acc: 0.6521
Epoch 27/30 | train | Loss: 0.8333 | Acc: 0.6506
Epoch 27/30 |  val  | Loss: 0.8314 | Acc: 0.6521
Epoch 28/30 | train | Loss: 0.8332 | Acc: 0.6508
Epoch 28/30 |  val  | Loss: 0.8361 | Acc: 0.6496
Epoch 29/30 | train | Loss: 0.8331 | Acc: 0.6507
Epoch 29/30 |  val  | Loss: 0.8300 | Acc: 0.6530
Epoch 30/30 | train | Loss: 0.8330 | Acc: 0.6509
Epoch 30/30 |  val  | Loss: 0.8279 | Acc: 0.6532
Work Done.
using  cuda
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 101, in train
    obses, samples = create_dataset_from_json(episode_dir, load_prop=load_prop)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/dataloader.py", line 69, in create_dataset_from_json
    unit_id, label = to_label(action)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/dataloader.py", line 17, in to_label
    elif str[0] == 'r': # citytile
TypeError: 'type' object is not subscriptable
using  cuda
xxxxxx
xxxxxx
xxxxxx
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 101, in train
    obses, samples = create_dataset_from_json(episode_dir, load_prop=load_prop)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/dataloader.py", line 69, in create_dataset_from_json
    unit_id, label = to_label(action)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/dataloader.py", line 25, in to_label
    return unit_id, label
UnboundLocalError: local variable 'unit_id' referenced before assignment
using  cuda
xxxxxx
obses: 12628 samples: 139842
north: 40020
south: 33825
west : 30187
east : 30137
bcity: 5673
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 130, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 17, in train_model
    for net in net:
UnboundLocalError: local variable 'net' referenced before assignment
using  cuda
xxxxxx
xxxxxx
obses: 12520 samples: 136663
north: 28914
south: 30442
west : 30518
east : 28786
bcity: 5196
research: 9111
build_worker: 3696
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 115, in train
    train, val = train_test_split(samples, test_size=0.1, random_state=42, stratify=labels)
NameError: name 'labels' is not defined
using  cuda
xxxxxx
xxxxxx
xxxxxx
xxxxxx
obses: 12196 samples: 146468
north: 28784
south: 30355
west : 35063
east : 33389
bcity: 5705
research: 9274
build_worker: 3898
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 136, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 32, in train_model
    for item in dataloader:
  File "/home/l/liuxiao/anaconda3/envs/cuda100/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 346, in __next__
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/l/liuxiao/anaconda3/envs/cuda100/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/l/liuxiao/anaconda3/envs/cuda100/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/dataloader.py", line 227, in __getitem__
    state, distance_mask, map_mask = make_input(obs, unit_id)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/dataloader.py", line 161, in make_input
    cooldown = float(str[5])
TypeError: 'type' object is not subscriptable
using  cuda
obses: 12527 samples: 145640
north: 31276
south: 31821
west : 33005
east : 30399
bcity: 5757
research: 9179
build_worker: 4203
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 136, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 32, in train_model
    for item in dataloader:
  File "/home/l/liuxiao/anaconda3/envs/cuda100/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 346, in __next__
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/l/liuxiao/anaconda3/envs/cuda100/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/l/liuxiao/anaconda3/envs/cuda100/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/dataloader.py", line 227, in __getitem__
    state, distance_mask, map_mask = make_input(obs, unit_id)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/dataloader.py", line 206, in make_input
    distance_mask = np.zeroes((32,32))
AttributeError: module 'numpy' has no attribute 'zeroes'
using  cuda
obses: 13113 samples: 132881
north: 29567
south: 27689
west : 29366
east : 28616
bcity: 4959
research: 9151
build_worker: 3533
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 136, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 40, in train_model
    optimizers[item[2]].zero_grad()
TypeError: only integer tensors of a single element can be converted to an index
using  cuda
obses: 12166 samples: 144890
north: 28468
south: 32303
west : 31435
east : 34688
bcity: 4739
research: 9733
build_worker: 3524
tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 136, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 40, in train_model
    optimizers[item[2]].zero_grad()
TypeError: only integer tensors of a single element can be converted to an index
using  cuda
obses: 12947 samples: 146384
north: 34347
south: 34128
west : 34602
east : 37361
bcity: 5946
Epoch 1/2 | train | Loss: 0.0235 | Acc: 0.2699
Epoch 1/2 |  val  | Loss: 0.0226 | Acc: 0.3228
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 116, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 66, in train_model
    traced = torch.jit.trace(net.cpu(), torch.rand(1, 20, 32, 32))
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/jit/_trace.py", line 742, in trace
    _module_class,
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/jit/_trace.py", line 940, in trace_module
    _force_outplace,
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 725, in _call_impl
    result = self._slow_forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 709, in _slow_forward
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 115, in forward
    x = self.relu(self.encode(x))
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 99, in encode
    x = self.relu(self.conv_skips[i](x) + self.conv_blocks[i](x)) 
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 725, in _call_impl
    result = self._slow_forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 709, in _slow_forward
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 423, in forward
    return self._conv_forward(input, self.weight)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 420, in _conv_forward
    self.padding, self.dilation, self.groups)
RuntimeError: Given groups=1, weight of size [64, 21, 1, 1], expected input[1, 20, 32, 32] to have 21 channels, but got 20 channels instead
using  cuda
obses: 13128 samples: 127964
north: 29174
south: 29744
west : 30992
east : 32381
bcity: 5673
Epoch 1/2 | train | Loss: 0.0238 | Acc: 0.2615
Epoch 1/2 |  val  | Loss: 0.0229 | Acc: 0.2894
Epoch 2/2 | train | Loss: 0.0228 | Acc: 0.3124
Epoch 2/2 |  val  | Loss: 0.0229 | Acc: 0.3174
Work Done.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          using  cuda
obses: 12617 samples: 130010
north: 30693
south: 30026
west : 32048
east : 32407
bcity: 4836
Epoch 1/2 | train | Loss: 0.0233 | Acc: 0.2861
Epoch 1/2 |  val  | Loss: 0.0227 | Acc: 0.2998
Epoch 2/2 | train | Loss: 0.0225 | Acc: 0.3213
Epoch 2/2 |  val  | Loss: 0.0226 | Acc: 0.3313
Work Done.
using  cuda
obses: 11685 samples: 111792
north: 29127
south: 23906
west : 27920
east : 26897
bcity: 3942
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 116, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 39, in train_model
    policy = net([states,distance_m,map_m])
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 129, in forward
    x = self.relu(self.encode(input))
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 110, in encode
    x = self.relu(self.conv_skips[i](x) + self.conv_blocks[i](x)) 
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 60, in forward
    return self.deconv(x)    
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/container.py", line 117, in forward
    input = module(input)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 929, in forward
    output_padding, self.groups, self.dilation)
RuntimeError: output padding must be smaller than either stride or dilation, but got output_padding_height: 1 output_padding_width: 1 stride_height: 1 stride_width: 1 dilation_height: 1 dilation_width: 1
/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/tensor.py:593: RuntimeWarning: Iterating over a tensor might cause the trace to be incorrect. Passing a tensor of different shape won't change the number of iterations executed (and might lead to errors or silently give incorrect results).
  'incorrect results).', category=RuntimeWarning)
using  cuda
obses: 12450 samples: 114232
north: 26093
south: 27038
west : 29072
east : 27926
bcity: 4103
Epoch 1/2 | train | Loss: 0.0237 | Acc: 0.2740
Epoch 1/2 |  val  | Loss: 0.0227 | Acc: 0.3034
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 116, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 66, in train_model
    traced = torch.jit.trace(net.cpu(), torch.rand(1, 21, 32, 32))
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/jit/_trace.py", line 742, in trace
    _module_class,
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/jit/_trace.py", line 940, in trace_module
    _force_outplace,
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 725, in _call_impl
    result = self._slow_forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 709, in _slow_forward
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 129, in forward
    x = self.relu(self.encode(input))
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 108, in encode
    x, distance_m, map_m = input
ValueError: not enough values to unpack (expected 3, got 1)
using  cuda
obses: 12176 samples: 93513
north: 22603
south: 20903
west : 22415
east : 23617
bcity: 3975
Epoch 1/2 | train | Loss: 0.0238 | Acc: 0.2865
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 114, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 37, in train_model
    policy = net(states)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 129, in forward
    x = self.relu(self.encode(input))
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 111, in encode
    x = x * distance_m * map_m
RuntimeError: The size of tensor a (64) must match the size of tensor b (8) at non-singleton dimension 1
using  cuda
obses: 13069 samples: 150919
north: 34018
south: 37959
west : 34992
east : 37656
bcity: 6294
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 114, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 37, in train_model
    policy = net(states)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 129, in forward
    x = self.relu(self.encode(input))
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 111, in encode
    x = x * distance_m * map_m
RuntimeError: The size of tensor a (64) must match the size of tensor b (19) at non-singleton dimension 1
using  cuda
obses: 12879 samples: 130614
north: 29480
south: 31351
west : 32184
east : 32600
bcity: 4999

Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 114, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 37, in train_model
    policy = net(states)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 131, in forward
    x = self.relu(self.encode(input))
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 113, in encode
    x = x * distance_m * map_m
RuntimeError: The size of tensor a (64) must match the size of tensor b (48) at non-singleton dimension 1
using  cuda
obses: 12336 samples: 121837
north: 30044
south: 27171
west : 30243
east : 30053
bcity: 4326
Epoch 1/2 | train | Loss: 1.5148 | Acc: 0.2828
Epoch 1/2 |  val  | Loss: 1.4318 | Acc: 0.3169
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 114, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 64, in train_model
    traced = torch.jit.trace(net.cpu(), torch.rand(1, 21, 32, 32))
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/jit/_trace.py", line 742, in trace
    _module_class,
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/jit/_trace.py", line 940, in trace_module
    _force_outplace,
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 725, in _call_impl
    result = self._slow_forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 709, in _slow_forward
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 131, in forward
    x = self.relu(self.encode(input))
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 108, in encode
    x, distance_m, map_m = input[:,0:21], input[:,21], input[:,22]
IndexError: index 21 is out of bounds for dimension 1 with size 21
using  cuda
obses: 12545 samples: 136824
north: 32005
south: 32300
west : 33133
east : 34172
bcity: 5214
Epoch 1/2 | train | Loss: 1.5044 | Acc: 0.2948
Epoch 1/2 |  val  | Loss: 1.4603 | Acc: 0.3143
Epoch 2/2 | train | Loss: 1.4377 | Acc: 0.3262
Epoch 2/2 |  val  | Loss: 1.4188 | Acc: 0.3394
Work Done.
using  cuda
Traceback (most recent call last):
  File "main.py", line 24, in <module>
    main(vars(config))
  File "main.py", line 20, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 95, in train
    obses, samples = create_dataset_from_json(episode_dir, load_prop=load_prop)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/dataloader.py", line 38, in create_dataset_from_json
    data = json.load(f)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/json/__init__.py", line 296, in load
    parse_constant=parse_constant, object_pairs_hook=object_pairs_hook, **kw)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/json/__init__.py", line 348, in loads
    return _default_decoder.decode(s)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
KeyboardInterrupt
using  cuda
obses: 12489 samples: 112871
north: 27118
south: 26392
west : 27319
east : 26989
bcity: 5053
Epoch 1/2 | train | Loss: 1.5353 | Acc: 0.2657
Epoch 1/2 |  val  | Loss: 1.4646 | Acc: 0.3026
Epoch 2/2 | train | Loss: 1.4625 | Acc: 0.3051
Epoch 2/2 |  val  | Loss: 1.4470 | Acc: 0.3191
Work Done.
using  cuda
obses: 13050 samples: 137970
north: 31651
south: 31726
west : 36218
east : 33495
bcity: 4880
Epoch 1/2 | train | Loss: 1.4880 | Acc: 0.2991
Epoch 1/2 |  val  | Loss: 1.4239 | Acc: 0.3351
Epoch 2/2 | train | Loss: 1.4232 | Acc: 0.3343
Epoch 2/2 |  val  | Loss: 1.4214 | Acc: 0.3388
Work Done.
using  cuda
obses: 13050 samples: 137970
north: 31651
south: 31726
west : 36218
east : 33495
bcity: 4880
Epoch 1/2 | train | Loss: 1.4754 | Acc: 0.3063
Epoch 1/2 |  val  | Loss: 1.4211 | Acc: 0.3335
Epoch 2/2 | train | Loss: 1.4133 | Acc: 0.3406
Epoch 2/2 |  val  | Loss: 1.4005 | Acc: 0.3508
Work Done.
                                                                                                                                                                                                                                                                                                                using  cuda
obses: 13050 samples: 137970
north: 31651
south: 31726
west : 36218
east : 33495
bcity: 4880
Epoch 1/2 | train | Loss: 1.4754 | Acc: 0.3053
Epoch 1/2 |  val  | Loss: 1.4219 | Acc: 0.3326
Epoch 2/2 | train | Loss: 1.4113 | Acc: 0.3421
Epoch 2/2 |  val  | Loss: 1.3934 | Acc: 0.3523
Work Done.
using  cuda
obses: 13050 samples: 137970
north: 31651
south: 31726
west : 36218
east : 33495
bcity: 4880
Traceback (most recent call last):
  File "main.py", line 25, in <module>
    main(vars(config))
  File "main.py", line 21, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 121, in train
    net = Autoencoder(option=option).to(device)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 111, in __init__
    self.conv_skips, self.conv_blocks, self.in_feature = make_layers(input_shape, self.conv_layers)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 66, in make_layers
    for layer in layers:
TypeError: 'NoneType' object is not iterable
                                                                                                                                                                                                                                                                                                                using  cuda
obses: 13050 samples: 137970
north: 31651
south: 31726
west : 36218
east : 33495
bcity: 4880
Epoch 1/2 | train | Loss: 1.4921 | Acc: 0.2987
Epoch 1/2 |  val  | Loss: 1.4508 | Acc: 0.2948
Epoch 2/2 | train | Loss: 1.4184 | Acc: 0.3363
Epoch 2/2 |  val  | Loss: 1.4039 | Acc: 0.3488
Work Done.
                                                                                                                                                                                                                                                                                                                using  cuda
obses: 13050 samples: 137970
north: 31651
south: 31726
west : 36218
east : 33495
bcity: 4880
option: 1 load prop: 0.01
Epoch 1/2 | train | Loss: 1.4833 | Acc: 0.2956
Epoch 1/2 |  val  | Loss: 1.4216 | Acc: 0.3363
Epoch 2/2 | train | Loss: 1.4221 | Acc: 0.3347
Epoch 2/2 |  val  | Loss: 1.4068 | Acc: 0.3481
Work Done.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          using  cuda
obses: 124695 samples: 1202907
north: 279481
south: 278803
west : 298971
east : 295625
bcity: 50027
option: 0 load prop: 0.1
Epoch 1/5 | train | Loss: 1.4591 | Acc: 0.2993
Epoch 1/5 |  val  | Loss: 1.4170 | Acc: 0.3297
Epoch 2/5 | train | Loss: 1.4182 | Acc: 0.3327
Epoch 2/5 |  val  | Loss: 1.3931 | Acc: 0.3531
Epoch 3/5 | train | Loss: 1.3787 | Acc: 0.3637
Epoch 3/5 |  val  | Loss: 1.3258 | Acc: 0.3972
Epoch 4/5 | train | Loss: 1.3300 | Acc: 0.3940
Epoch 4/5 |  val  | Loss: 1.2925 | Acc: 0.4162
Epoch 5/5 | train | Loss: 1.3035 | Acc: 0.4103
Epoch 5/5 |  val  | Loss: 1.2677 | Acc: 0.4330
Work Done.
using  cuda
obses: 1621 samples: 17052
north: 4164
south: 4082
west : 4225
east : 4118
bcity: 463
option: 1 load prop: 0.01
Traceback (most recent call last):
  File "main.py", line 25, in <module>
    main(vars(config))
  File "main.py", line 21, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 130, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 48, in train_model
    policy = net(states)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 151, in forward
    x = self.relu(self.encode(input))
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 132, in encode
    x = self.relu(self.conv_skips[i](x) + self.conv_blocks[i](x))
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 423, in forward
    return self._conv_forward(input, self.weight)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 420, in _conv_forward
    self.padding, self.dilation, self.groups)
RuntimeError: Given groups=1, weight of size [64, 21, 1, 1], expected input[64, 23, 32, 32] to have 21 channels, but got 23 channels instead
using  cuda
obses: 1621 samples: 17052
north: 4164
south: 4082
west : 4225
east : 4118
bcity: 463
option: 1 load prop: 0.01
Epoch 1/5 | train | Loss: 1.7766 | Acc: 0.2507
Epoch 1/5 |  val  | Loss: 1.4706 | Acc: 0.2638
Epoch 2/5 | train | Loss: 1.4693 | Acc: 0.2704
Epoch 2/5 |  val  | Loss: 1.4406 | Acc: 0.3072
Epoch 3/5 | train | Loss: 1.4519 | Acc: 0.2826
Epoch 3/5 |  val  | Loss: 1.4538 | Acc: 0.2790
Epoch 4/5 | train | Loss: 1.4428 | Acc: 0.2956
Epoch 4/5 |  val  | Loss: 1.4283 | Acc: 0.3142
Epoch 5/5 | train | Loss: 1.4341 | Acc: 0.3059
Epoch 5/5 |  val  | Loss: 1.4208 | Acc: 0.3224
Work Done. Total cost: 233.2044632434845 s
using  cuda
obses: 1621 samples: 17052
north: 4164
south: 4082
west : 4225
east : 4118
bcity: 463
option: 1 load prop: 0.01
Epoch 1/5 | train | Loss: 1.7816 | Acc: 0.2566
Epoch 1/5 |  val  | Loss: 1.4618 | Acc: 0.2638
Traceback (most recent call last):
  File "main.py", line 25, in <module>
    main(vars(config))
  File "main.py", line 21, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 130, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 75, in train_model
    traced = torch.jit.trace(net.cpu(), torch.rand(1, CHANNEL, 32, 32))
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/jit/_trace.py", line 742, in trace
    _module_class,
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/jit/_trace.py", line 940, in trace_module
    _force_outplace,
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 725, in _call_impl
    result = self._slow_forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 709, in _slow_forward
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 151, in forward
    x = self.relu(self.encode(input))
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 126, in encode
    x, distance_m, map_m = input[:,:19], input[:,19], input[:,20]
IndexError: index 19 is out of bounds for dimension 1 with size 19
using  cuda
obses: 1621 samples: 17052
north: 4164
south: 4082
west : 4225
east : 4118
bcity: 463
option: 1 load prop: 0.01
Epoch 1/5 | train | Loss: 1.7751 | Acc: 0.2553
Epoch 1/5 |  val  | Loss: 1.4647 | Acc: 0.2468
Epoch 2/5 | train | Loss: 1.4709 | Acc: 0.2658
Epoch 2/5 |  val  | Loss: 1.4620 | Acc: 0.2632
Epoch 3/5 | train | Loss: 1.4537 | Acc: 0.2848
Epoch 3/5 |  val  | Loss: 1.4490 | Acc: 0.2790
Epoch 4/5 | train | Loss: 1.4419 | Acc: 0.2906
Epoch 4/5 |  val  | Loss: 1.4261 | Acc: 0.2966
Epoch 5/5 | train | Loss: 1.4344 | Acc: 0.3027
Epoch 5/5 |  val  | Loss: 1.4388 | Acc: 0.2989
Work Done. Total cost: 242.0201768875122 s
using  cuda
obses: 1621 samples: 17052
north: 4164
south: 4082
west : 4225
east : 4118
bcity: 463
option: 1 load prop: 0.01
Epoch 1/5 | train | Loss: 1.7697 | Acc: 0.2553
Epoch 1/5 |  val  | Loss: 1.4589 | Acc: 0.2550
Epoch 2/5 | train | Loss: 1.4702 | Acc: 0.2662
Epoch 2/5 |  val  | Loss: 1.4521 | Acc: 0.2726
Epoch 3/5 | train | Loss: 1.4552 | Acc: 0.2829
Epoch 3/5 |  val  | Loss: 1.4475 | Acc: 0.2913
Epoch 4/5 | train | Loss: 1.4402 | Acc: 0.2921
Epoch 4/5 |  val  | Loss: 1.4263 | Acc: 0.2984
Epoch 5/5 | train | Loss: 1.4312 | Acc: 0.3080
Epoch 5/5 |  val  | Loss: 1.4331 | Acc: 0.3095
Work Done. Total cost: 241.45314764976501 s
using  cuda
obses: 1621 samples: 17052
north: 4164
south: 4082
west : 4225
east : 4118
bcity: 463
option: 1 load prop: 0.01
Epoch 1/5 | train | Loss: 1.6453 | Acc: 0.2487
Epoch 1/5 |  val  | Loss: 1.4912 | Acc: 0.2638
Epoch 2/5 | train | Loss: 1.4657 | Acc: 0.2711
Epoch 2/5 |  val  | Loss: 1.4442 | Acc: 0.2978
Epoch 3/5 | train | Loss: 1.4489 | Acc: 0.2900
Epoch 3/5 |  val  | Loss: 1.4440 | Acc: 0.2913
Epoch 4/5 | train | Loss: 1.4434 | Acc: 0.2883
Epoch 4/5 |  val  | Loss: 1.4252 | Acc: 0.3054
Epoch 5/5 | train | Loss: 1.4320 | Acc: 0.3048
Epoch 5/5 |  val  | Loss: 1.4216 | Acc: 0.3200
Work Done. Total cost: 235.51880860328674 s
using  cuda
obses: 2754 samples: 22376
north: 5640
south: 5108
west : 5385
east : 5213
bcity: 1030
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.6784 | Acc: 0.2457
Epoch 1/5 |  val  | Loss: 1.4989 | Acc: 0.2534
Epoch 2/5 | train | Loss: 1.5016 | Acc: 0.2716
Epoch 2/5 |  val  | Loss: 1.4837 | Acc: 0.2672
Epoch 3/5 | train | Loss: 1.4847 | Acc: 0.2895
Epoch 3/5 |  val  | Loss: 1.4543 | Acc: 0.3101
Epoch 4/5 | train | Loss: 1.4716 | Acc: 0.3029
Epoch 4/5 |  val  | Loss: 1.4657 | Acc: 0.3021
Epoch 5/5 | train | Loss: 1.4605 | Acc: 0.3159
Epoch 5/5 |  val  | Loss: 1.4336 | Acc: 0.3423
Work Done. Total cost: 311.26914739608765 s
using  cuda
obses: 2754 samples: 22376
north: 5640
south: 5108
west : 5385
east : 5213
bcity: 1030
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.7370 | Acc: 0.2502
Epoch 1/5 |  val  | Loss: 1.4854 | Acc: 0.2846
Epoch 2/5 | train | Loss: 1.4994 | Acc: 0.2831
Epoch 2/5 |  val  | Loss: 1.4591 | Acc: 0.3088
Epoch 3/5 | train | Loss: 1.4779 | Acc: 0.2985
Epoch 3/5 |  val  | Loss: 1.4578 | Acc: 0.3056
Epoch 4/5 | train | Loss: 1.4679 | Acc: 0.3095
Epoch 4/5 |  val  | Loss: 1.4447 | Acc: 0.3280
Epoch 5/5 | train | Loss: 1.4496 | Acc: 0.3237
Epoch 5/5 |  val  | Loss: 1.4311 | Acc: 0.3378
Work Done. Total cost: 322.31454157829285 s
using  cuda
obses: 2754 samples: 22376
north: 5640
south: 5108
west : 5385
east : 5213
bcity: 1030
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.7873 | Acc: 0.2522
Epoch 1/5 |  val  | Loss: 1.4943 | Acc: 0.2583
Epoch 2/5 | train | Loss: 1.4973 | Acc: 0.2810
Epoch 2/5 |  val  | Loss: 1.4638 | Acc: 0.2980
Epoch 3/5 | train | Loss: 1.4757 | Acc: 0.3024
Epoch 3/5 |  val  | Loss: 1.4454 | Acc: 0.3244
Epoch 4/5 | train | Loss: 1.4611 | Acc: 0.3096
Epoch 4/5 |  val  | Loss: 1.4505 | Acc: 0.3097
Epoch 5/5 | train | Loss: 1.4421 | Acc: 0.3322
Epoch 5/5 |  val  | Loss: 1.4231 | Acc: 0.3320
Work Done. Total cost: 301.3099434375763 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.5961 | Acc: 0.2751
Epoch 1/5 |  val  | Loss: 1.4358 | Acc: 0.3323
Epoch 2/5 | train | Loss: 1.4445 | Acc: 0.3193
Epoch 2/5 |  val  | Loss: 1.4236 | Acc: 0.3248
Epoch 3/5 | train | Loss: 1.4297 | Acc: 0.3303
Epoch 3/5 |  val  | Loss: 1.4139 | Acc: 0.3403
Epoch 4/5 | train | Loss: 1.4164 | Acc: 0.3408
Epoch 4/5 |  val  | Loss: 1.4104 | Acc: 0.3343
Epoch 5/5 | train | Loss: 1.4022 | Acc: 0.3498
Epoch 5/5 |  val  | Loss: 1.4030 | Acc: 0.3511
Work Done. Total cost: 535.8866782188416 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.5645 | Acc: 0.2778
Epoch 1/5 |  val  | Loss: 1.4368 | Acc: 0.3366
Epoch 2/5 | train | Loss: 1.4413 | Acc: 0.3221
Epoch 2/5 |  val  | Loss: 1.4224 | Acc: 0.3226
Epoch 3/5 | train | Loss: 1.4275 | Acc: 0.3288
Epoch 3/5 |  val  | Loss: 1.4111 | Acc: 0.3328
Epoch 4/5 | train | Loss: 1.4117 | Acc: 0.3451
Epoch 4/5 |  val  | Loss: 1.4031 | Acc: 0.3620
Epoch 5/5 | train | Loss: 1.3928 | Acc: 0.3576
Epoch 5/5 |  val  | Loss: 1.3972 | Acc: 0.3543
Work Done. Total cost: 524.7488448619843 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.5602 | Acc: 0.2797
Epoch 1/5 |  val  | Loss: 1.4375 | Acc: 0.3301
Epoch 2/5 | train | Loss: 1.4432 | Acc: 0.3219
Epoch 2/5 |  val  | Loss: 1.4194 | Acc: 0.3313
Epoch 3/5 | train | Loss: 1.4299 | Acc: 0.3318
Epoch 3/5 |  val  | Loss: 1.4253 | Acc: 0.3353
Epoch 4/5 | train | Loss: 1.4131 | Acc: 0.3411
Epoch 4/5 |  val  | Loss: 1.4093 | Acc: 0.3526
Epoch 5/5 | train | Loss: 1.3981 | Acc: 0.3555
Epoch 5/5 |  val  | Loss: 1.3861 | Acc: 0.3586
Work Done. Total cost: 544.9416964054108 s
using  cuda
obses: 2754 samples: 22376
north: 5640
south: 5108
west : 5385
east : 5213
bcity: 1030
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.7240 | Acc: 0.2561
Epoch 1/5 |  val  | Loss: 1.5049 | Acc: 0.2426
Epoch 2/5 | train | Loss: 1.4980 | Acc: 0.2782
Epoch 2/5 |  val  | Loss: 1.4759 | Acc: 0.2788
Epoch 3/5 | train | Loss: 1.4788 | Acc: 0.2993
Epoch 3/5 |  val  | Loss: 1.4447 | Acc: 0.3275
Epoch 4/5 | train | Loss: 1.4645 | Acc: 0.3115
Epoch 4/5 |  val  | Loss: 1.4526 | Acc: 0.3110
Epoch 5/5 | train | Loss: 1.4494 | Acc: 0.3274
Epoch 5/5 |  val  | Loss: 1.4263 | Acc: 0.3418
Work Done. Total cost: 302.13223361968994 s
using  cuda
obses: 2754 samples: 22376
north: 5640
south: 5108
west : 5385
east : 5213
bcity: 1030
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.7771 | Acc: 0.2498
Epoch 1/5 |  val  | Loss: 1.4922 | Acc: 0.2788
Traceback (most recent call last):
  File "main.py", line 26, in <module>
    main(vars(config))
  File "main.py", line 22, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 132, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 75, in train_model
    traced = torch.jit.trace(net.cpu(), torch.rand(1, CHANNEL, 32, 32))
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/jit/_trace.py", line 742, in trace
    _module_class,
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/jit/_trace.py", line 940, in trace_module
    _force_outplace,
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 725, in _call_impl
    result = self._slow_forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 709, in _slow_forward
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 151, in forward
    x = self.relu(self.encode(input))
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 126, in encode
    x, distance_m, map_m = input[:,:19], input[:,19], input[:,20]
IndexError: index 19 is out of bounds for dimension 1 with size 19
using  cuda
obses: 2754 samples: 22376
north: 5640
south: 5108
west : 5385
east : 5213
bcity: 1030
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.7719 | Acc: 0.2481
Epoch 1/5 |  val  | Loss: 1.4956 | Acc: 0.2708
Epoch 2/5 | train | Loss: 1.5015 | Acc: 0.2760
Epoch 2/5 |  val  | Loss: 1.4632 | Acc: 0.3043
Epoch 3/5 | train | Loss: 1.4804 | Acc: 0.2881
Epoch 3/5 |  val  | Loss: 1.4546 | Acc: 0.3070
Epoch 4/5 | train | Loss: 1.4690 | Acc: 0.3047
Epoch 4/5 |  val  | Loss: 1.4504 | Acc: 0.3177
Epoch 5/5 | train | Loss: 1.4612 | Acc: 0.3121
Epoch 5/5 |  val  | Loss: 1.4465 | Acc: 0.3244
Work Done. Total cost: 308.87699604034424 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.6368 | Acc: 0.2735
Epoch 1/5 |  val  | Loss: 1.4464 | Acc: 0.3203
Epoch 2/5 | train | Loss: 1.4480 | Acc: 0.3148
Epoch 2/5 |  val  | Loss: 1.4325 | Acc: 0.3331
Epoch 3/5 | train | Loss: 1.4314 | Acc: 0.3296
Epoch 3/5 |  val  | Loss: 1.4240 | Acc: 0.3366
Epoch 4/5 | train | Loss: 1.4206 | Acc: 0.3367
Epoch 4/5 |  val  | Loss: 1.4093 | Acc: 0.3433
Epoch 5/5 | train | Loss: 1.4094 | Acc: 0.3470
Epoch 5/5 |  val  | Loss: 1.4030 | Acc: 0.3581
Work Done. Total cost: 551.2761509418488 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.5971 | Acc: 0.2725
Epoch 1/5 |  val  | Loss: 1.4439 | Acc: 0.3238
Epoch 2/5 | train | Loss: 1.4479 | Acc: 0.3130
Epoch 2/5 |  val  | Loss: 1.4389 | Acc: 0.3126
Epoch 3/5 | train | Loss: 1.4345 | Acc: 0.3229
Epoch 3/5 |  val  | Loss: 1.4289 | Acc: 0.3321
Epoch 4/5 | train | Loss: 1.4199 | Acc: 0.3364
Epoch 4/5 |  val  | Loss: 1.4116 | Acc: 0.3386
Epoch 5/5 | train | Loss: 1.4062 | Acc: 0.3471
Epoch 5/5 |  val  | Loss: 1.3937 | Acc: 0.3591
Work Done. Total cost: 572.889342546463 s
using  cuda
obses: 2754 samples: 22376
north: 5640
south: 5108
west : 5385
east : 5213
bcity: 1030
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.6832 | Acc: 0.2459
Epoch 1/5 |  val  | Loss: 1.4968 | Acc: 0.2462
Epoch 2/5 | train | Loss: 1.5020 | Acc: 0.2664
Epoch 2/5 |  val  | Loss: 1.4840 | Acc: 0.2726
Epoch 3/5 | train | Loss: 1.4853 | Acc: 0.2931
Epoch 3/5 |  val  | Loss: 1.4540 | Acc: 0.3065
Epoch 4/5 | train | Loss: 1.4696 | Acc: 0.3032
Epoch 4/5 |  val  | Loss: 1.4596 | Acc: 0.3007
Epoch 5/5 | train | Loss: 1.4497 | Acc: 0.3254
Epoch 5/5 |  val  | Loss: 1.4210 | Acc: 0.3365
Work Done. Total cost: 322.38637924194336 s
using  cuda
obses: 2754 samples: 22376
north: 5640
south: 5108
west : 5385
east : 5213
bcity: 1030
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.7781 | Acc: 0.2448
Epoch 1/5 |  val  | Loss: 1.5253 | Acc: 0.2324
Epoch 2/5 | train | Loss: 1.5134 | Acc: 0.2558
Epoch 2/5 |  val  | Loss: 1.4883 | Acc: 0.2685
Epoch 3/5 | train | Loss: 1.5020 | Acc: 0.2701
Epoch 3/5 |  val  | Loss: 1.4752 | Acc: 0.2985
Epoch 4/5 | train | Loss: 1.4901 | Acc: 0.2801
Epoch 4/5 |  val  | Loss: 1.4660 | Acc: 0.2855
Epoch 5/5 | train | Loss: 1.4833 | Acc: 0.2862
Epoch 5/5 |  val  | Loss: 1.4609 | Acc: 0.3016
Work Done. Total cost: 307.97713971138 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.6344 | Acc: 0.2664
Epoch 1/5 |  val  | Loss: 1.4596 | Acc: 0.2956
Epoch 2/5 | train | Loss: 1.4451 | Acc: 0.3099
Epoch 2/5 |  val  | Loss: 1.4230 | Acc: 0.3311
Epoch 3/5 | train | Loss: 1.2902 | Acc: 0.4077
Epoch 3/5 |  val  | Loss: 1.2266 | Acc: 0.4272
Epoch 4/5 | train | Loss: 1.1967 | Acc: 0.4616
Epoch 4/5 |  val  | Loss: 1.1646 | Acc: 0.4824
Epoch 5/5 | train | Loss: 1.1444 | Acc: 0.4894
Epoch 5/5 |  val  | Loss: 1.1382 | Acc: 0.4906
Work Done. Total cost: 561.97265458107 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.5602 | Acc: 0.2806
Epoch 1/5 |  val  | Loss: 1.4423 | Acc: 0.3184
Epoch 2/5 | train | Loss: 1.4023 | Acc: 0.3434
Epoch 2/5 |  val  | Loss: 1.2557 | Acc: 0.4387
Epoch 3/5 | train | Loss: 1.2109 | Acc: 0.4625
Epoch 3/5 |  val  | Loss: 1.1637 | Acc: 0.4911
Epoch 4/5 | train | Loss: 1.1024 | Acc: 0.5260
Epoch 4/5 |  val  | Loss: 1.0842 | Acc: 0.5491
Epoch 5/5 | train | Loss: 1.0188 | Acc: 0.5720
Epoch 5/5 |  val  | Loss: 0.9917 | Acc: 0.5953
Work Done. Total cost: 564.7438478469849 s
using  cuda
obses: 2754 samples: 22376
north: 5640
south: 5108
west : 5385
east : 5213
bcity: 1030
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.7246 | Acc: 0.2476
Epoch 1/5 |  val  | Loss: 1.5020 | Acc: 0.2690
Epoch 2/5 | train | Loss: 1.4975 | Acc: 0.2721
Epoch 2/5 |  val  | Loss: 1.4691 | Acc: 0.2842
Epoch 3/5 | train | Loss: 1.4595 | Acc: 0.3071
Epoch 3/5 |  val  | Loss: 1.4001 | Acc: 0.3521
Epoch 4/5 | train | Loss: 1.3439 | Acc: 0.3856
Epoch 4/5 |  val  | Loss: 1.2778 | Acc: 0.4526
Epoch 5/5 | train | Loss: 1.2129 | Acc: 0.4622
Epoch 5/5 |  val  | Loss: 1.1557 | Acc: 0.5031
Work Done. Total cost: 311.4404604434967 s
using  cuda
obses: 2754 samples: 22376
north: 5640
south: 5108
west : 5385
east : 5213
bcity: 1030
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.7723 | Acc: 0.2483
Epoch 1/5 |  val  | Loss: 1.4993 | Acc: 0.2511
Epoch 2/5 | train | Loss: 1.4914 | Acc: 0.2787
Epoch 2/5 |  val  | Loss: 1.4119 | Acc: 0.3150
Epoch 3/5 | train | Loss: 1.4040 | Acc: 0.3393
Epoch 3/5 |  val  | Loss: 1.3313 | Acc: 0.3928
Epoch 4/5 | train | Loss: 1.2834 | Acc: 0.4203
Epoch 4/5 |  val  | Loss: 1.2091 | Acc: 0.4656
Epoch 5/5 | train | Loss: 1.1723 | Acc: 0.4868
Epoch 5/5 |  val  | Loss: 1.1349 | Acc: 0.5107
Work Done. Total cost: 317.84342861175537 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.6116 | Acc: 0.2800
Epoch 1/5 |  val  | Loss: 1.4338 | Acc: 0.3466
Epoch 2/5 | train | Loss: 1.3352 | Acc: 0.3908
Epoch 2/5 |  val  | Loss: 1.2059 | Acc: 0.4642
Epoch 3/5 | train | Loss: 1.1698 | Acc: 0.4773
Epoch 3/5 |  val  | Loss: 1.1120 | Acc: 0.5064
Epoch 4/5 | train | Loss: 1.0814 | Acc: 0.5256
Epoch 4/5 |  val  | Loss: 1.0738 | Acc: 0.5393
Epoch 5/5 | train | Loss: 1.0160 | Acc: 0.5646
Epoch 5/5 |  val  | Loss: 1.0206 | Acc: 0.5738
Work Done. Total cost: 543.1668622493744 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.5947 | Acc: 0.2695
Epoch 1/5 |  val  | Loss: 1.4298 | Acc: 0.3316
Epoch 2/5 | train | Loss: 1.4020 | Acc: 0.3332
Epoch 2/5 |  val  | Loss: 1.3641 | Acc: 0.3548
Epoch 3/5 | train | Loss: 1.2667 | Acc: 0.4206
Epoch 3/5 |  val  | Loss: 1.1549 | Acc: 0.4806
Epoch 4/5 | train | Loss: 1.1122 | Acc: 0.5088
Epoch 4/5 |  val  | Loss: 1.0802 | Acc: 0.5316
Epoch 5/5 | train | Loss: 1.0301 | Acc: 0.5558
Epoch 5/5 |  val  | Loss: 1.0323 | Acc: 0.5743
Work Done. Total cost: 542.1963763237 s
using  cuda
obses: 2754 samples: 22376
north: 5640
south: 5108
west : 5385
east : 5213
bcity: 1030
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.7292 | Acc: 0.2430
Epoch 1/5 |  val  | Loss: 1.4965 | Acc: 0.2721
Epoch 2/5 | train | Loss: 1.4799 | Acc: 0.2905
Epoch 2/5 |  val  | Loss: 1.3852 | Acc: 0.3494
Epoch 3/5 | train | Loss: 1.3819 | Acc: 0.3477
Epoch 3/5 |  val  | Loss: 1.3104 | Acc: 0.4088
Epoch 4/5 | train | Loss: 1.2732 | Acc: 0.4257
Epoch 4/5 |  val  | Loss: 1.2184 | Acc: 0.4593
Epoch 5/5 | train | Loss: 1.1735 | Acc: 0.4856
Epoch 5/5 |  val  | Loss: 1.1382 | Acc: 0.5134
Work Done. Total cost: 309.69394183158875 s
using  cuda
obses: 2754 samples: 22376
north: 5640
south: 5108
west : 5385
east : 5213
bcity: 1030
option: 1 load prop: 1.0
Traceback (most recent call last):
  File "main.py", line 26, in <module>
    main(vars(config))
  File "main.py", line 22, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 133, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 48, in train_model
    policy = net(states)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 31, in forward
    h = F.relu_(self.conv0(x))
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 18, in forward
    h = self.conv(x)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 423, in forward
    return self._conv_forward(input, self.weight)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 420, in _conv_forward
    self.padding, self.dilation, self.groups)
RuntimeError: Given groups=1, weight of size [32, 21, 3, 3], expected input[64, 23, 32, 32] to have 21 channels, but got 23 channels instead
using  cuda
obses: 2754 samples: 22376
north: 5640
south: 5108
west : 5385
east : 5213
bcity: 1030
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.2400 | Acc: 0.4781
Epoch 1/5 |  val  | Loss: 1.0718 | Acc: 0.5612
Epoch 2/5 | train | Loss: 0.9823 | Acc: 0.5979
Epoch 2/5 |  val  | Loss: 0.9965 | Acc: 0.5853
Epoch 3/5 | train | Loss: 0.8625 | Acc: 0.6522
Epoch 3/5 |  val  | Loss: 0.9127 | Acc: 0.6327
Epoch 4/5 | train | Loss: 0.7766 | Acc: 0.6910
Epoch 4/5 |  val  | Loss: 0.8984 | Acc: 0.6466
Epoch 5/5 | train | Loss: 0.7139 | Acc: 0.7142
Epoch 5/5 |  val  | Loss: 0.8810 | Acc: 0.6640
Work Done. Total cost: 258.3075611591339 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 1 load prop: 1.0
Epoch 1/5 | train | Loss: 1.1148 | Acc: 0.5266
Epoch 1/5 |  val  | Loss: 0.9465 | Acc: 0.6105
Epoch 2/5 | train | Loss: 0.8761 | Acc: 0.6439
Epoch 2/5 |  val  | Loss: 0.8735 | Acc: 0.6549
Epoch 3/5 | train | Loss: 0.7823 | Acc: 0.6825
Epoch 3/5 |  val  | Loss: 0.8360 | Acc: 0.6679
Epoch 4/5 | train | Loss: 0.7187 | Acc: 0.7126
Epoch 4/5 |  val  | Loss: 0.8393 | Acc: 0.6629
Epoch 5/5 | train | Loss: 0.6708 | Acc: 0.7311
Epoch 5/5 |  val  | Loss: 0.7915 | Acc: 0.6879
Work Done. Total cost: 470.0417597293854 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 1 load prop: 1.0
Epoch 1/15 | train | Loss: 1.1148 | Acc: 0.5266
Epoch 1/15 |  val  | Loss: 0.9465 | Acc: 0.6105
Epoch 2/15 | train | Loss: 0.8761 | Acc: 0.6439
Epoch 2/15 |  val  | Loss: 0.8735 | Acc: 0.6549
Epoch 3/15 | train | Loss: 0.7823 | Acc: 0.6825
Epoch 3/15 |  val  | Loss: 0.8360 | Acc: 0.6679
Epoch 4/15 | train | Loss: 0.7187 | Acc: 0.7126
Epoch 4/15 |  val  | Loss: 0.8393 | Acc: 0.6629
Epoch 5/15 | train | Loss: 0.6708 | Acc: 0.7311
Epoch 5/15 |  val  | Loss: 0.7915 | Acc: 0.6879
Epoch 6/15 | train | Loss: 0.6273 | Acc: 0.7517
Epoch 6/15 |  val  | Loss: 0.8065 | Acc: 0.6896
Epoch 7/15 | train | Loss: 0.5893 | Acc: 0.7656
Epoch 7/15 |  val  | Loss: 0.7740 | Acc: 0.6994
Epoch 8/15 | train | Loss: 0.5514 | Acc: 0.7824
Epoch 8/15 |  val  | Loss: 0.7922 | Acc: 0.7021
Epoch 9/15 | train | Loss: 0.5189 | Acc: 0.7948
Epoch 9/15 |  val  | Loss: 0.7919 | Acc: 0.6936
Epoch 10/15 | train | Loss: 0.4911 | Acc: 0.8069
Epoch 10/15 |  val  | Loss: 0.8016 | Acc: 0.6916
Epoch 11/15 | train | Loss: 0.4602 | Acc: 0.8220
Epoch 11/15 |  val  | Loss: 0.8046 | Acc: 0.7019
Epoch 12/15 | train | Loss: 0.4359 | Acc: 0.8297
Epoch 12/15 |  val  | Loss: 0.8261 | Acc: 0.7009
Epoch 13/15 | train | Loss: 0.4097 | Acc: 0.8410
Epoch 13/15 |  val  | Loss: 0.8590 | Acc: 0.7039
Epoch 14/15 | train | Loss: 0.3847 | Acc: 0.8532
Epoch 14/15 |  val  | Loss: 0.8501 | Acc: 0.7011
Epoch 15/15 | train | Loss: 0.3665 | Acc: 0.8581
Epoch 15/15 |  val  | Loss: 0.9044 | Acc: 0.7001
Work Done. Total cost: 1434.9965872764587 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 1 load prop: 1.0
Epoch 1/15 | train | Loss: 1.5548 | Acc: 0.2798
Epoch 1/15 |  val  | Loss: 1.4134 | Acc: 0.3308
Epoch 2/15 | train | Loss: 1.3830 | Acc: 0.3461
Epoch 2/15 |  val  | Loss: 1.3293 | Acc: 0.3765
Epoch 3/15 | train | Loss: 1.2504 | Acc: 0.4382
Epoch 3/15 |  val  | Loss: 1.1687 | Acc: 0.4799
Epoch 4/15 | train | Loss: 1.1099 | Acc: 0.5161
Epoch 4/15 |  val  | Loss: 1.0748 | Acc: 0.5398
Epoch 5/15 | train | Loss: 1.0259 | Acc: 0.5640
Epoch 5/15 |  val  | Loss: 1.0139 | Acc: 0.5793
Epoch 6/15 | train | Loss: 0.9544 | Acc: 0.6006
Epoch 6/15 |  val  | Loss: 0.9810 | Acc: 0.5983
Epoch 7/15 | train | Loss: 0.8906 | Acc: 0.6318
Epoch 7/15 |  val  | Loss: 0.9397 | Acc: 0.6200
Epoch 8/15 | train | Loss: 0.8344 | Acc: 0.6583
Epoch 8/15 |  val  | Loss: 0.9387 | Acc: 0.6262
Epoch 9/15 | train | Loss: 0.7784 | Acc: 0.6818
Epoch 9/15 |  val  | Loss: 0.9012 | Acc: 0.6417
Epoch 10/15 | train | Loss: 0.7271 | Acc: 0.7054
Epoch 10/15 |  val  | Loss: 0.9003 | Acc: 0.6414
Epoch 11/15 | train | Loss: 0.6830 | Acc: 0.7254
Epoch 11/15 |  val  | Loss: 0.9070 | Acc: 0.6524
Epoch 12/15 | train | Loss: 0.6373 | Acc: 0.7469
Epoch 12/15 |  val  | Loss: 0.8897 | Acc: 0.6669
Epoch 13/15 | train | Loss: 0.5945 | Acc: 0.7657
Epoch 13/15 |  val  | Loss: 0.9126 | Acc: 0.6719
Epoch 14/15 | train | Loss: 0.5515 | Acc: 0.7838
Epoch 14/15 |  val  | Loss: 0.9596 | Acc: 0.6609
Epoch 15/15 | train | Loss: 0.5111 | Acc: 0.7991
Epoch 15/15 |  val  | Loss: 0.9619 | Acc: 0.6667
Work Done. Total cost: 1626.7883849143982 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 1 load prop: 1.0
Epoch 1/10 | train | Loss: 1.6109 | Acc: 0.4157
Epoch 1/10 |  val  | Loss: 1.0607 | Acc: 0.5588
Epoch 2/10 | train | Loss: 0.9735 | Acc: 0.6061
Epoch 2/10 |  val  | Loss: 0.9498 | Acc: 0.6235
Epoch 3/10 | train | Loss: 0.8615 | Acc: 0.6576
Epoch 3/10 |  val  | Loss: 0.8996 | Acc: 0.6622
Epoch 4/10 | train | Loss: 0.7857 | Acc: 0.6896
Epoch 4/10 |  val  | Loss: 0.8024 | Acc: 0.6824
Epoch 5/10 | train | Loss: 0.7225 | Acc: 0.7180
Epoch 5/10 |  val  | Loss: 0.7707 | Acc: 0.6959
Epoch 6/10 | train | Loss: 0.6782 | Acc: 0.7331
Epoch 6/10 |  val  | Loss: 0.7534 | Acc: 0.7034
Epoch 7/10 | train | Loss: 0.6264 | Acc: 0.7555
Epoch 7/10 |  val  | Loss: 0.7578 | Acc: 0.7171
Epoch 8/10 | train | Loss: 0.5852 | Acc: 0.7734
Epoch 8/10 |  val  | Loss: 0.7307 | Acc: 0.7131
Epoch 9/10 | train | Loss: 0.5443 | Acc: 0.7891
Epoch 9/10 |  val  | Loss: 0.7471 | Acc: 0.7139
Epoch 10/10 | train | Loss: 0.5018 | Acc: 0.8054
Epoch 10/10 |  val  | Loss: 0.7809 | Acc: 0.7251
Work Done. Total cost: 960.734295129776 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 3 load prop: 1.0
Traceback (most recent call last):
  File "main.py", line 26, in <module>
    main(vars(config))
  File "main.py", line 22, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 133, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 48, in train_model
    policy = net(states)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 163, in forward
    x = self.linear2(x)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/linear.py", line 93, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/functional.py", line 1690, in linear
    ret = torch.addmm(bias, input, weight.t())
RuntimeError: mat1 dim 1 must match mat2 dim 0
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 3 load prop: 1.0
Epoch 1/10 | train | Loss: 1.5634 | Acc: 0.3925
Epoch 1/10 |  val  | Loss: 1.0172 | Acc: 0.5810
Epoch 2/10 | train | Loss: 0.9429 | Acc: 0.6184
Epoch 2/10 |  val  | Loss: 0.8985 | Acc: 0.6242
Epoch 3/10 | train | Loss: 0.8128 | Acc: 0.6755
Epoch 3/10 |  val  | Loss: 0.8256 | Acc: 0.6639
Epoch 4/10 | train | Loss: 0.7433 | Acc: 0.7026
Epoch 4/10 |  val  | Loss: 0.7629 | Acc: 0.6949
Epoch 5/10 | train | Loss: 0.6850 | Acc: 0.7283
Epoch 5/10 |  val  | Loss: 0.7578 | Acc: 0.6986
Epoch 6/10 | train | Loss: 0.6410 | Acc: 0.7456
Epoch 6/10 |  val  | Loss: 0.7552 | Acc: 0.6981
Epoch 7/10 | train | Loss: 0.5914 | Acc: 0.7672
Epoch 7/10 |  val  | Loss: 0.7753 | Acc: 0.7036
Epoch 8/10 | train | Loss: 0.5483 | Acc: 0.7853
Epoch 8/10 |  val  | Loss: 0.7446 | Acc: 0.7283
Epoch 9/10 | train | Loss: 0.5056 | Acc: 0.8037
Epoch 9/10 |  val  | Loss: 0.7627 | Acc: 0.7303
Epoch 10/10 | train | Loss: 0.4620 | Acc: 0.8207
Epoch 10/10 |  val  | Loss: 0.7345 | Acc: 0.7251
Work Done. Total cost: 1752.1143925189972 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 4 load prop: 1.0
Traceback (most recent call last):
  File "main.py", line 26, in <module>
    main(vars(config))
  File "main.py", line 22, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 133, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 48, in train_model
    policy = net(states)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 170, in forward
    x = self.linear2(x)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/linear.py", line 93, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/functional.py", line 1690, in linear
    ret = torch.addmm(bias, input, weight.t())
RuntimeError: mat1 dim 1 must match mat2 dim 0
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 4 load prop: 1.0
Epoch 1/10 | train | Loss: 1.7804 | Acc: 0.3326
Epoch 1/10 |  val  | Loss: 1.1461 | Acc: 0.5166
Epoch 2/10 | train | Loss: 0.9845 | Acc: 0.5961
Epoch 2/10 |  val  | Loss: 0.8595 | Acc: 0.6544
Epoch 3/10 | train | Loss: 0.8208 | Acc: 0.6666
Epoch 3/10 |  val  | Loss: 0.8116 | Acc: 0.6584
Epoch 4/10 | train | Loss: 0.7423 | Acc: 0.7035
Epoch 4/10 |  val  | Loss: 0.7625 | Acc: 0.6881
Epoch 5/10 | train | Loss: 0.6908 | Acc: 0.7239
Epoch 5/10 |  val  | Loss: 0.7689 | Acc: 0.6984
Epoch 6/10 | train | Loss: 0.6376 | Acc: 0.7479
Epoch 6/10 |  val  | Loss: 0.7700 | Acc: 0.6931
Epoch 7/10 | train | Loss: 0.5961 | Acc: 0.7663
Epoch 7/10 |  val  | Loss: 0.7585 | Acc: 0.7064
Epoch 8/10 | train | Loss: 0.5554 | Acc: 0.7851
Epoch 8/10 |  val  | Loss: 0.7243 | Acc: 0.7223
Epoch 9/10 | train | Loss: 0.5108 | Acc: 0.8016
Epoch 9/10 |  val  | Loss: 0.7484 | Acc: 0.7144
Epoch 10/10 | train | Loss: 0.5764 | Acc: 0.7762
Epoch 10/10 |  val  | Loss: 0.7852 | Acc: 0.7141
Work Done. Total cost: 4054.280335664749 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 3 load prop: 1.0
Traceback (most recent call last):
  File "main.py", line 26, in <module>
    main(vars(config))
  File "main.py", line 22, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 133, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 48, in train_model
    policy = net(states)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 170, in forward
    x = self.linear2(x)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/linear.py", line 93, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/functional.py", line 1690, in linear
    ret = torch.addmm(bias, input, weight.t())
RuntimeError: mat1 dim 1 must match mat2 dim 0
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 3 load prop: 1.0
Epoch 1/10 | train | Loss: 1.6155 | Acc: 0.4006
Epoch 1/10 |  val  | Loss: 1.0345 | Acc: 0.5743
Epoch 2/10 | train | Loss: 0.9003 | Acc: 0.6345
Epoch 2/10 |  val  | Loss: 0.8782 | Acc: 0.6474
Epoch 3/10 | train | Loss: 0.7876 | Acc: 0.6860
Epoch 3/10 |  val  | Loss: 0.7745 | Acc: 0.6869
Epoch 4/10 | train | Loss: 0.7135 | Acc: 0.7132
Epoch 4/10 |  val  | Loss: 0.7751 | Acc: 0.6879
Epoch 5/10 | train | Loss: 0.6560 | Acc: 0.7403
Epoch 5/10 |  val  | Loss: 0.7540 | Acc: 0.7166
Epoch 6/10 | train | Loss: 0.6104 | Acc: 0.7610
Epoch 6/10 |  val  | Loss: 0.7417 | Acc: 0.7059
Epoch 7/10 | train | Loss: 0.5550 | Acc: 0.7816
Epoch 7/10 |  val  | Loss: 0.7354 | Acc: 0.7151
Epoch 8/10 | train | Loss: 0.5134 | Acc: 0.7978
Epoch 8/10 |  val  | Loss: 0.7682 | Acc: 0.7241
Epoch 9/10 | train | Loss: 0.4637 | Acc: 0.8198
Epoch 9/10 |  val  | Loss: 0.7842 | Acc: 0.7278
Epoch 10/10 | train | Loss: 0.4209 | Acc: 0.8384
Epoch 10/10 |  val  | Loss: 0.8175 | Acc: 0.7303
Work Done. Total cost: 4135.29052066803 s
using  cuda
obses: 4336 samples: 40048
north: 10465
south: 9240
west : 10651
east : 8133
bcity: 1559
option: 3 load prop: 1.0
Traceback (most recent call last):
  File "main.py", line 26, in <module>
    main(vars(config))
  File "main.py", line 22, in main
    train(config)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 133, in train
    num_epochs=num_epochs, device=device, save_every=save_every)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/train.py", line 48, in train_model
    policy = net(states)
  File "/home/l/liuxiao/anaconda3/envs/luxai/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 168, in forward
    x = self.encode(input)
  File "/home/l/liuxiao/CS5446_Project/my-works/imitation_learning/model.py", line 140, in encode
    x, distance_m, map_m = input[:,:22], input[:,22], input[:,21]
IndexError: index 22 is out of bounds for dimension 1 with size 20
